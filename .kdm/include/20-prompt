# Always write lines to history file on each prompt
export PROMPT_COMMAND="history -a"

# Disable powerline if disabled in bash-env.conf
if grep -q 'ENABLE_POWERLINE=0' "${BASH_ENV_FILE_CONFIG}"; then
	export PROMPT_COMMAND="${PROMPT_COMMAND}; _prompt_generate"
	return
fi

# Disable powerline if powerline-daemon is not installed
if ! hash powerline-daemon; then
	export PROMPT_COMMAND="${PROMPT_COMMAND}; _prompt_generate"
	return
fi

# Disable powerline if powerline script is missing
if ! test -s "${BASH_ENV_FILE_POWERLINE}"; then
	export PROMPT_COMMAND="${PROMPT_COMMAND}; _prompt_generate"
	return
fi

# Generate prompt with _prompt_generate function in .bashrc, or with powerline
export PROMPT_COMMAND="${PROMPT_COMMAND}; _powerline_status_wrapper _powerline_set_prompt"

# vim: set syntax=sh filetype=sh ts=2 sw=2 tw=0 noet :
