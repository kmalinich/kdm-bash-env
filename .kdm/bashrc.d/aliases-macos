# Aliases: macOS-only (regardless of GNU conversion)

# Bounce if we're not on Darwin
[[ "${UNAME_KERNEL_NAME}" != "Darwin" ]] && return 0

# PING_WAIT for use in ping functions
export PING_WAIT="-t 1"

# EFI partition mount for disk0, disk1, and disk2
[[ -b /dev/disk0s1 ]] && alias efi-mount-0='diskutil mount /dev/disk0s1; [[ -d /Volumes/EFI/EFI ]] && cd /Volumes/EFI/EFI'
[[ -b /dev/disk1s1 ]] && alias efi-mount-1='diskutil mount /dev/disk1s1; [[ -d /Volumes/EFI/EFI ]] && cd /Volumes/EFI/EFI'
[[ -b /dev/disk2s1 ]] && alias efi-mount-2='diskutil mount /dev/disk2s1; [[ -d /Volumes/EFI/EFI ]] && cd /Volumes/EFI/EFI'

# Show listening ports a bit easier
alias net-listening-ipv4="netstat -an | grep -E '^..p4.*.LISTEN' | sort"
alias net-listening-ipv6="netstat -an | grep -E '^..p6.*.LISTEN' | sort"

# Fake lspci
if hash dspci && ! hash lspci; then alias lspci='dspci'; fi

# Fake lsusb
hash system_profiler && alias lsusb='system_profiler SPUSBDataType'

# Clear font cache
alias macos-repair-fontcache='sudo atsutil databases -remove'

# Lock screen and screensaver shortcuts
alias macos-screen-off='pmset displaysleepnow'
alias macos-screen-lock='/System/Library/CoreServices/Menu\ Extras/User.menu/Contents/Resources/CGSession -suspend'
alias macos-screen-saver='open -a ScreenSaverEngine'
alias macos-sleep="osascript -e 'tell app \"System Events\" to sleep'"

# El Capitan and up
if [[ "${UNAME_KERNEL_RELEASE%%.*}" -ge "15" ]]; then
	# Enable and disable indexing
	alias macos-indexing-enable='sudo mdutil -a -i on'
	alias macos-indexing-disable='sudo mdutil -a -i off'

	# Flush DNS cache
	alias macos-repair-dns='sudo dscacheutil -flushcache; sudo killall -HUP mDNSResponder'
else # Pre-El Capitan
	alias macos-repair-dns='sudo killall -HUP mDNSResponder'
	alias macos-repair-diskperms="sudo diskutil repairPermissions /; sudo chown -R \${USER} /usr/local"
fi

# Yosemite/El Capitan
if [[ "${UNAME_KERNEL_RELEASE%%.*}" == "14" || "${UNAME_KERNEL_RELEASE%%.*}" == "15" ]]; then
	# Repair disk permissions
	alias macos-repair-diskperms="sudo repair_packages --repair --standard-pkgs /; sudo chown -R \${USER} /usr/local"
fi

# vim: set syntax=sh filetype=sh ts=2 sw=2 tw=0 noet :
